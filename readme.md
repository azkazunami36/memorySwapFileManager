# MemorySwapFileManager
MemorySwapFileManagerは、Ubuntu OSのメモリの状況を監視し、スワップファイルを自動的に調整するプログラムです。メモリの使用状況に応じてスワップファイルを作成、削除、有効化、無効化します。

ディスクスペースに余裕を持たせることのできるプログラムです。予め大容量のスワップ領域を割り当てたりする必要はもうありません。

## 仕様
大まかな仕様は以下です。
- スワップフォルダ: `/swapFolder`
- スワップファイルのサイズ: 1GB
- スワップファイルの作成条件: スワップの空き容量が500MB未満の場合
- スワップファイルの削除条件: スワップの空き容量が2GB以上の場合
- 不正なスワップファイルの条件: サイズが800MB未満または1.2GB以上のファイル、スワップフォルダ直下以外にあるスワップファイル

## 注意事項
- Ubuntuでのみ動作を検証しています。その他のLinux OSでは動作を確認していません。
- 個人利用で、危険性を理解した上で利用することを推奨しています。
- macOS、Windowsでは実行できません。エラーが発生します。
- このプログラムをインストールするにはスーパーユーザー権限が必要です。実行する際には`sudo`を使用してください。
- 現在のプログラムはルートディレクトリに全てのスワップファイルがある前提で動作をします。バグが起こる可能性があるので注意してください。
- 初回起動時は、元から存在するスワップファイルを移動したり、削除したりします。その時にディスク領域を占領する可能性があるので、注意してください。２度目からはその影響はなくなります。
- 安定して動作するとは限りません。`systemctl status memorySwapFilemanager`で状況をチェックすることをおすすめします。

## 使い方
このプログラムを利用する方法を解説します。インストールをする前に、以下の注意事項を確認してください。
- ディスクの空き容量が必要です。スワップファイルが多く予約されている場合、例として32GBなどが予約されているとインストール時に32GBの領域を埋める可能性があります。
- インストール前に存在するスワップファイルは全て削除されます。
- スワップにはドライブを指定可能ですが、このシステムではドライブがスワップに指定されている場合、`rm`コマンドを利用して削除してしまいます。この意味がわからない場合は、よく調べた上で利用してください。修正予定はまだありません(容易に削除を回避すると動作にバグが発生する恐れがあるため)。

### インストール
1. このリポジトリをクローンします。
```sh
git clone https://github.com/azkazunami36/memorySwapFileManager.git
```
2. 必要な依存関係をインストールします(インストールも行われます)。実行の際にパスワードを求められる場合があります。
```sh
cd memorySwapFileManager
npm install
```

3. インストールの許可が求められるので、`y`を入力しEnterを押します。
```sh
メモリスワップファイルマネージャーのインストーラーが起動しています。
この操作を続行するとシステムに操作が加えられます。注意事項を理解した上で続行してください。
メモリスワップファイルマネージャーのインストールを実行してもよろしいですか？(y/n)> y
```

4. インストールが完了すると、プログラムは自動的にメモリの状況を監視し、スワップファイルを調整します。これ以上の操作の必要はありません。

### systemdを使わずに利用する
もしsystemctlを使わずに利用したい場合、インストールを拒否することで利用が可能です。インストールの際に`n`と応答することで、ただの`npm i`となります。

起動方法です。このリポジトリ内で
```sh
sudo node main.js
```
を実行するだけです。もしJSファイルがない場合は`npx tsc`を実行すると、JSファイルを作成できます。

### アンインストール
アンインストールも容易です。しかし、以下に注意してください。
- メモリ・スワップ領域の空き容量が少ない場合に実行はしないでください。
- ディスクの空き容量が少ない場合に実行はしないでください。
- インストール前に作成したスワップファイルはすでに存在しません。再度作成する必要があります。

方法です。
1. このリポジトリ内で以下を入力します。パスワードの入力が求められる場合があります。
```sh
npm run uninstall
```

2. アンインストールの許可が出るので、注意事項を読んだ上で`y`を入力し、Enterを押します。
```sh
メモリスワップファイルマネージャーのアンインストーラーが起動しています。
この操作を続行するとシステムに操作が加えられます。一時的にメモリスワップファイルマネージャーのシステムを実行します。
注意：メモリの空き容量をチェックしてください。もし空き容量が不足している場合、アンインストーラーは続行されません。
メモリスワップファイルマネージャーのアンインストールを実行してもよろしいですか？(y/n)> y
```

3. すべてのスワップファイルが削除され、サービスも終了します。必要に応じてこのREADME.mdが入ったフォルダも削除して構いません。

## ライセンス
このプロジェクトはMITライセンスの下で公開されています。詳細はLICENSEファイルを参照してください。
